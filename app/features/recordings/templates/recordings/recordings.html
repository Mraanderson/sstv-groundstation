{% extends "base.html" %}
{% block title %}Recordings â€” SSTV Groundstation{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="mb-0">Recordings</h2>
</div>

{% if recordings %}
<div class="table-responsive">
    <table class="table table-striped table-hover align-middle">
        <thead class="table-dark">
            <tr>
                <th>Satellite</th>
                <th>Time</th>
                <th>Frequency</th>
                <th>Mode</th>
                <th>SSTV</th>
                <th>Calls</th>
                <th>Verdict</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
        {% for rec in recordings %}
            <tr>
                <td>{{ rec.meta.satellite }}</td>
                <td>{{ rec.meta.timestamp }}</td>
                <td>{{ rec.meta.frequency }} MHz</td>
                <td>{{ rec.meta.mode }}</td>
                <td>
                    {% if rec.meta.sstv_detected %}
                        <span class="badge bg-success">Yes</span>
                    {% else %}
                        <span class="badge bg-secondary">No</span>
                    {% endif %}
                </td>
                <td>{{ rec.meta.callsigns|join(', ') }}</td>
                <td>
                    {% if rec.meta.verdict == "PASS" %}
                        <span class="badge bg-success">PASS</span>
                    {% else %}
                        <span class="badge bg-danger">FAIL</span>
                    {% endif %}
                </td>
                <td>
                    {% if rec.wav_exists %}
                        <a href="{{ url_for('recordings.download_recording', filename=rec.base + '.wav') }}"
                           class="btn btn-sm btn-primary">Download</a>
                    {% endif %}
                    <button class="btn btn-sm btn-outline-danger"
                            onclick="deleteRecording('{{ rec.base }}')">Delete</button>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="alert alert-info">No recordings found.</div>
{% endif %}

<script>
function deleteRecording(base) {
    if (confirm("Delete this recording?")) {
        fetch(`/recordings/delete/${base}`, { method: "POST" })
            .then(() => location.reload());
    }
}
</script>
{% endblock %}
