{% extends "base.html" %}
{% block title %}Gallery{% endblock %}
{% block content %}
<h1 class="mb-4">üñºÔ∏è Image Gallery</h1>
{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
<div class="alert-area mb-3">
{% for category, message in messages %}
<div class="alert alert-{{ category }}">{{ message | safe }}</div>
{% endfor %}
</div>
{% endif %}
{% endwith %}
<!-- üì§ Image Upload Form - Now styled with input-group for visual consistency -->
<h5>Upload New Image</h5>
<p class="text-muted">
Upload images (PNG, JPEG, etc.) to the shared gallery.
This upload section uses the same styling as the Recorded Passes page.
</p>
<form method="POST" action="{{ url_for('gallery.upload_image') }}" enctype="multipart/form-data" class="mb-4">
<div class="input-group">
<input type="file"
name="file"
accept="image/*"
class="form-control"
required>
<button type="submit" class="btn btn-success">
üì§ Upload Image
</button>
</div>
</form>
<hr>
<div id="gallery-container">
{% include "gallery/_gallery_items.html" %}
</div>
<script>
// Example: refresh gallery every 60 seconds
async function refreshGallery() {
try {
// Fetching the partial content
const response = await fetch("{{ url_for('gallery.gallery_partial') }}");
if (response.ok) {
const html = await response.text();
// Update the gallery content
document.getElementById("gallery-container").innerHTML = html;
    // Optional: After a successful upload, you might want to stop the flash messages 
    // from disappearing on refresh, but for now, we just update the list.
  }
} catch (err) {
  console.error(&quot;Error refreshing gallery:&quot;, err);
}
    }
// Refresh every 60 seconds
setInterval(refreshGallery, 60000);
</script>
{% endblock %}
