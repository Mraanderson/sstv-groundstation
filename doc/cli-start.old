cat SSTV.sh
#!/bin/bash

REPO_URL="https://github.com/Mraanderson/sstv-groundstation.git"
APP_DIR="$HOME/sstv-groundstation"

# Function to clone a specific branch
clone_branch() {
    local branch=$1
    echo "Clearing local folder..."
    rm -rf "$APP_DIR"
    echo "Cloning branch '$branch'..."
    git clone -b "$branch" "$REPO_URL" "$APP_DIR"
}

# Function to list remote branches and select one
list_and_clone_branch() {
    echo "Fetching remote branches..."
    branches=$(git ls-remote --heads "$REPO_URL" | awk '{print $2}' | sed 's|refs/heads/||')
    echo "Available branches:"
    select branch in $branches; do
        if [ -n "$branch" ]; then
            clone_branch "$branch"
            break
        else
            echo "Invalid selection."
        fi
    done
}

# Menu
echo "=============================="
echo "   SSTV Groundstation Setup   "
echo "=============================="
echo "1) Clear & clone MAIN branch"
echo "2) Clear & clone from branch list"
echo "3) Run from current folder"
echo "=============================="
read -p "Select an option: " choice

case $choice in
    1)
        clone_branch "main"
        ;;
    2)
        list_and_clone_branch
        ;;
    3)
        if [ -d "$APP_DIR" ]; then
            echo "Using existing folder: $APP_DIR"
        else
            echo "Error: $APP_DIR does not exist. Please clone first."
            exit 1
        fi
        ;;
    *)
        echo "Invalid choice."
        exit 1
        ;;
esac

# Set up virtual environment
cd "$APP_DIR" || exit
if [ ! -d "venv" ]; then
    echo "Creating virtual environment..."
    python3 -m venv venv
fi

echo "Activating virtual environment..."
source venv/bin/activate

# Install dependencies
if [ -f "requirements.txt" ]; then
    echo "Installing dependencies..."
    pip install --upgrade pip
    pip install -r requirements.txt
else
    echo "No requirements.txt found!"
fi

# Launch the app
echo "Launching Flask app..."
export FLASK_APP=run.py
export FLASK_ENV=development
flask run --host=0.0.0.0 --port=5000
